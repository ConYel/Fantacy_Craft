---
title: "Make the functions for the chars"
subtitle: "?????"
author: "Constantinos Yeles (Konstantinos Geles)"
date: "`r format(Sys.time(), '%a_%b_%d_%Y')`"
output:
  pdf_document:
    toc: yes
    toc_depth: 3
  html_document:
    toc: yes
    toc_depth: 3
    theme: paper 
editor_options:
  chunk_output_type: console
---

## libraries
```{r}
library(dplyr)
library(tidyr)
library(magrittr)
library(stringr)
```


## tables we need
### species info
```{r}

species <- readxl::read_xlsx("FC_tables/Species.xlsx")
species_gen <- species %>% 
  select(!starts_with(c("Att","Extr")))

species_Att <- species %>% 
  select(Species, starts_with("Att")) %>% 
  pivot_longer(cols = starts_with("Attr_"), 
               names_to = "che_me_ne", values_to = "Attribute") %>% 
  pivot_longer(cols = starts_with("Att_Score"), 
               names_to = "fotte", values_to = "score") %>%
  filter(score != 0, Attribute != "No") %>% 
  mutate(che_me_ne = che_me_ne %>% str_remove("Attr_") %>% as.integer(),
         fotte = fotte %>% str_remove("Att_Score_") %>% as.integer()) %>% 
  filter(che_me_ne == fotte) %>% 
  select(-c(che_me_ne, fotte)) %>%
  separate_rows(Attribute)

species_Ext <- species %>% 
  select(Species, starts_with("Extr")) %>% 
  pivot_longer(cols = c(Extra_1:Extra_10)) %>% 
  filter(!value == "No") %>% 
  select(-name)
```

### talents info
```{r}
talents <- readxl::read_xlsx("FC_tables/Talents.xlsx")

talents_Att <- talents %>% 
  select(Talent, starts_with(c("Attri", "Modi"))) %>% 
  pivot_longer(cols = starts_with("Attr"), 
               names_to = "che_me_ne", values_to = "Attribute") %>% 
  pivot_longer(cols = starts_with("Mod"), 
               names_to = "fotte", values_to = "score") %>%
  mutate(che_me_ne = che_me_ne %>% str_remove("Attribute_") %>% as.integer(),
         fotte = fotte %>% str_remove("Modifier_") %>% as.integer()) %>% 
  filter(che_me_ne == fotte) %>% 
  select(-c(che_me_ne, fotte)) %>%
  distinct(Talent, Attribute, score)

talents_Benef <- talents %>% 
  select(Talent, starts_with("Benef")) %>% 
  pivot_longer(cols = starts_with("Benef"), 
               names_to = "che_me_ne", values_to = "Benefit") %>% 
  filter(Benefit != "No") %>% 
  select(!che_me_ne)

talents_1 <- talents %>% 
  select(!starts_with(c("Attri", "Modi", "Benef")))
```

### specialties info
```{r}
specialties <- readxl::read_xlsx("FC_tables/Specialties.xlsx")

specialties_1 <- specialties %>% 
  select(!starts_with("Extra")) 

specialties_extra <- specialties %>% 
  select(Specialty, starts_with("Extra")) %>% 
  pivot_longer(cols = starts_with("Extra"), 
               names_to = "che_me_ne", values_to = "Extra") %>% 
  filter(Extra != "No") %>% 
  select(!che_me_ne)

```
 
### Attributes information and table
```{r}
Attr_sum <- readxl::read_xlsx("FC_tables/Attributes/Attributes_summary.xlsx")
Attr_sum_sc <- readxl::read_xlsx("FC_tables/Attributes/Attributes_scores.xlsx")
Attr_scores <- readxl::read_xlsx("FC_tables/Attributes/Attributes_system.xlsx")
```

### Fucntions to get the Attributes
```{r}
## provide the count of each value you can use
## to put as an attribute
Attr_score_select <- function(att = "Sel1"){
  Attr_scores %>% 
    filter(scope == att) %>% 
    pivot_longer(-scope) %>% 
    count(value)
}

## change the number of the score you still have 
## (a function only made for inter activeness)
Attr_score_remove <- function(df, score){
    df %>% 
    mutate(n = ifelse(value == score, n-1, n)) %>% 
    drop_na()
}
```

### Functions to get a random char
```{r}

## get Attrb
get_r_attrb <- function(){
  Random_attrbs <- Attr_scores %>%
  slice_sample() %>% 
  pivot_longer(-scope) %>% 
  slice_sample(n = 6) %>% 
  pull(value)
  
  return(Random_attrbs)
}

get_r_origin <- function(){
  origin_species <- list()
  
  origin_species$general <- species_gen %>%
  slice_sample()
  
  origin_species$species_attrb <- species_Att %>%
  filter(Species == pull(origin_species$general, Species))
  
  origin_species$extras<- species_Ext %>%
  filter(Species == pull(origin_species$general, Species))
  
  if (pull(origin_species$general, Species) == "Human") {
    
  }
  return(origin_species)
}


Random_Character <- function(){
  Attributes <- tibble(Attr_sum, Attrb_main = get_r_attrb())
  return(Attributes)
}
```

## character final tables